import { HeroPattern } from '@/components/HeroPattern'

export const metadata = {
  title: 'Tool Installation',
  description:
    'Learn how to install, manage, and update tools in Power Platform ToolBox using the marketplace and registry system.',
}

export const sections = [
  { title: 'Tool Marketplace', id: 'tool-marketplace' },
  {
    title: 'Additional Installation Methods',
    id: 'additional-installation-methods',
  },
  { title: 'Managing Installed Tools', id: 'managing-installed-tools' },
  { title: 'Tool Registry System', id: 'tool-registry-system' },
  { title: 'Tool Permissions', id: 'tool-permissions' },
  { title: 'Troubleshooting', id: 'troubleshooting' },
  { title: 'Next Steps', id: 'next-steps' },
]

<HeroPattern />

# Tool Installation & Management

Power Platform ToolBox uses a marketplace-style registry system for discovering and installing tools. Learn how to find, install, update, and manage tools. {{ className: 'lead' }}

## Tool Marketplace {{ anchor: true }}

### Discovering Tools

The Tools Marketplace provides a centralized catalog of available tools:

1. Click **"Tools Marketplace"** in the sidebar

[![PPTB Tools Marketplace](images/screenshots/toolsinstallation-marketplace.png)](images/screenshots/toolsinstallation-marketplace.png)

2. Browse featured tools or search by name, author, or category
3. Select a tool to view details
   [![PPTB Tools details](images/screenshots/toolsinstallation-marketplace2.png)](images/screenshots/toolsinstallation-marketplace2.png)
   - Name and description
   - Author and version
   - Download count
   - Required permissions (if any above Dataverse access)
   - An author provided description of the tool
   - Screenshots (if available)
4. Click **"Install"** to add the tool to your PPTB installation

<Note>
  Tools are downloaded as pre-built packages from the PPTB registry. No npm or
  pnpm installation required on your machine.
</Note>

## Additional Installation Methods {{ anchor: true }}

For developers or private tools, PPTB supports installing directly from npm packages or your local filesystem.

<Warning>
  Installing from npm or local files is intended for development and testing
  purposes only. Use the marketplace whenever possible.
</Warning>

<Note>
  Both these methods require the Show Debug Setting to be enabled in Settings
  menu.
</Note>

### From npm (For Development & Private Packages)

For debugging, development, or installing private npm packages:

1. Ensure pnpm is installed on your system
2. Open Debug / Install by Package in the sidebar
3. Within the Install Tool by Package name, enter package name as shown on https://www.npmjs.com/  
   (e.g., `@your-org/your-tool`)
4. Click **"Install Package"**
5. PPTB installs via pnpm
6. Tool loads after installation

### From Local Files

For tool developers

1. Ensure pnpm is installed on your system
2. Open Debug / Install by Package in the sidebar
3. Click browse and select the folder where your tool is, this is usually the root folder of your tool project
4. Click **"Load Tool"**
5. PPTB installs the local tool
6. Tool loads after installation

<Note>
  Use this method for testing local tools during development or installing
  private npm packages not available in the marketplace.
</Note>

## Managing Installed Tools {{ anchor: true }}

### View Installed Tools

The **Installed Tools** panel shows all installed tools:

- Tool name and icon
- Version number
- Status (loaded, error, updating)
- Quick launch button

### Launch a Tool

1. Click on a tool in the Installed Tools panel
2. Tool loads in the main workspace, asking for a connection
3. Tool UI appears in main workspace area
4. Tool can now interact with active connection(s)

### Update a Tool

1. The Installed Tools panel will show an update badge for tools that have an update available
2. Click **"Update"** next to the tool
3. New version of the tool will be downloaded and update old version
4. The new version of the tool will be available

<Note>
  Updates are atomic - if an update fails, the previous version remains
  installed.
</Note>

### Uninstall a Tool

1. In the Installed Tools panel, click the trash icon next to the tool

2. Confirm uninstallation.
3. Tool and any stored preferences are removed

## Tool Registry System {{ anchor: true }}

Power Platform ToolBox uses a VS Code-style marketplace architecture:

### How It Works

```
1. Developer publishes tool to npm
   ↓
2. Registered developers submit their tool to PPTB registry via https://www.powerplatformtoolbox.com/submit-tool
   ↓
3. Automated validation checks package and data about the tool
   ↓
4. A manual review by the Power Platform ToolBox team will be completed
   ↓
5. Tool is approved and added to registry.
   ↓
6. Tool is available in PPTB marketplace
   ↓
7. Installation downloads pre-built archive
   ↓
8. Tool extracted and cached locally
   ↓
9. Tool appears in Installed Tools panel
```

### Registry Features

- **Pre-built Archives:** Tools distributed as ready-to-run packages
- **Version Management:** Track and install specific versions
- **Update Checks:** Automatic detection of new versions
- **Metadata:** Rich descriptions, icons, screenshots
- **Categories:** Organize tools by function
- **Search:** Find tools quickly by name or description

## Tool Permissions {{ anchor: true }}

Tools may required additional permissions beyond standard Dataverse access.

The first time you launch the tool, or the required permissions change, you will see a permission consent dialog.

[![PPTB Tool Permissions](images/screenshots/toolsinstallation-additionalpermissions.png)](images/screenshots/toolsinstallation-additionalpermissions.png)

Review the requested permissions carefully before accepting.

Additional details on permissions, please see the Tool Developer documentation [here](/tool-development/csp-configuration).

<Note>
  If you decline, the tool won't load. If you accept, your choice is saved and
  you won't see the dialog again for that tool, unless the permissions requested
  change.
</Note>

### Staying Safe

Follow these best practices when reviewing CSP exceptions:

<Properties>
  <Property name="Review Carefully">
    Read what the tool is requesting access to. Does it make sense for what the
    tool does?
  </Property>
  <Property name="Trust the Source">
    Only grant exceptions to tools from developers you trust or tools with good
    reviews in the marketplace.
  </Property>
  <Property name="Watch for Red Flags">
    Be suspicious if a simple tool requests access to many unrelated domains or
    services.
  </Property>
  <Property name="Revoke Anytime">
    You can revoke CSP permissions at any time in the tool settings if you
    change your mind.
  </Property>
</Properties>

### Example Scenarios

Here are common, legitimate reasons tools request CSP exceptions:

**Scenario 1: Data Visualization Tool**

```
Requests: script-src from https://cdn.jsdelivr.net
Reason: Loads a charting library to create graphs
```

**Scenario 2: Custom Branding Tool**

```
Requests: font-src from https://fonts.googleapis.com
           style-src from https://fonts.googleapis.com
Reason: Uses custom web fonts for professional appearance
```

<Note>
  Permissions are tool-specific, not global. Granting access for one tool
  doesn't affect other tools' permissions.
</Note>

## Troubleshooting {{ anchor: true }}

### Tool Won't Install

**Symptom:** Installation fails or hangs

**Solutions:**

- Check internet connectivity
- Verify registry server is accessible
- Check disk space is sufficient
- Try closing and reopening PPTB
- Check logs for specific errors

### Tool Won't Load

**Symptom:** Tool installed but won't launch

**Solutions:**

- Ensure Node.js 18+ is installed
- Check tool compatibility with PPTB version
- Look for errors in developer console
- Try uninstalling and reinstalling
- Report issue to tool author

### Tool Updates Fail

**Symptom:** Update downloads but doesn't apply

**Solutions:**

- Close the tool before updating
- Check write permissions in tool directory
- Verify sufficient disk space
- Manually uninstall and reinstall

### Missing Dependencies

**Symptom:** Tool reports missing dependencies

**Solutions:**

- Registry packages should be self-contained
- Report issue to tool author
- Check tool's npm package configuration
- Try reinstalling from marketplace

## Next Steps {{ anchor: true }}

<div className="not-prose mt-6 flex gap-3">
  <Button href="/quickstart" variant="text" arrow="right">
    <>Quick Start</>
  </Button>
  <Button href="/authentication" variant="text" arrow="right">
    <>Authentication</>
  </Button>
</div>
